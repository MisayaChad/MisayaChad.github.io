<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>超级账本 Hyperledger Fabric2.0 多机集群部署 | Misaya Chad Blogs</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="我们需要将容器分发到4个主机，本教程使用的是局域网下的四台主机。系统为Ubuntu和centos均可以。可以自己随便设置，保证能互相联通 在Fabric网络启动运行后，我们将使用Fabcar链码进行测试。总体流程如下：准备4台可以互相通信的主机，均为linu内核。构建一个叠加网络，将4个主机都加入该网络在主机1上准备所有资料，包括密码学资料、通道配置交易、每个节点的docker-compose文件">
<meta property="og:type" content="article">
<meta property="og:title" content="超级账本 Hyperledger Fabric2.0 多机集群部署">
<meta property="og:url" content="http://misayachad.github.io/2020/05/20/超级账本 Hyperledger Fabric2.0 多机集群部署/index.html">
<meta property="og:site_name" content="Misaya Chad Blogs">
<meta property="og:description" content="我们需要将容器分发到4个主机，本教程使用的是局域网下的四台主机。系统为Ubuntu和centos均可以。可以自己随便设置，保证能互相联通 在Fabric网络启动运行后，我们将使用Fabcar链码进行测试。总体流程如下：准备4台可以互相通信的主机，均为linu内核。构建一个叠加网络，将4个主机都加入该网络在主机1上准备所有资料，包括密码学资料、通道配置交易、每个节点的docker-compose文件">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="http://misayachad.github.io/images/fabric2.0多机集群部署结构.jpg">
<meta property="og:updated_time" content="2020-07-14T12:32:07.864Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="超级账本 Hyperledger Fabric2.0 多机集群部署">
<meta name="twitter:description" content="我们需要将容器分发到4个主机，本教程使用的是局域网下的四台主机。系统为Ubuntu和centos均可以。可以自己随便设置，保证能互相联通 在Fabric网络启动运行后，我们将使用Fabcar链码进行测试。总体流程如下：准备4台可以互相通信的主机，均为linu内核。构建一个叠加网络，将4个主机都加入该网络在主机1上准备所有资料，包括密码学资料、通道配置交易、每个节点的docker-compose文件">
<meta name="twitter:image" content="http://misayachad.github.io/images/fabric2.0多机集群部署结构.jpg">
  
    <link rel="alternate" href="/atom.xml" title="Misaya Chad Blogs" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Misaya Chad Blogs</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">Chad的个人技术博客</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://misayachad.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-超级账本 Hyperledger Fabric2.0 多机集群部署" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/05/20/超级账本 Hyperledger Fabric2.0 多机集群部署/" class="article-date">
  <time datetime="2020-05-20T07:33:30.000Z" itemprop="datePublished">2020-05-20</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/区块链/">区块链</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      超级账本 Hyperledger Fabric2.0 多机集群部署
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="我们需要将容器分发到4个主机，本教程使用的是局域网下的四台主机。系统为Ubuntu和centos均可以。可以自己随便设置，保证能互相联通"><a href="#我们需要将容器分发到4个主机，本教程使用的是局域网下的四台主机。系统为Ubuntu和centos均可以。可以自己随便设置，保证能互相联通" class="headerlink" title="我们需要将容器分发到4个主机，本教程使用的是局域网下的四台主机。系统为Ubuntu和centos均可以。可以自己随便设置，保证能互相联通"></a>我们需要将容器分发到4个主机，本教程使用的是局域网下的四台主机。系统为Ubuntu和centos均可以。可以自己随便设置，保证能互相联通</h1><p><img src="/images/fabric2.0多机集群部署结构.jpg" alt=""></p>
<h2 id="在Fabric网络启动运行后，我们将使用Fabcar链码进行测试。总体流程如下："><a href="#在Fabric网络启动运行后，我们将使用Fabcar链码进行测试。总体流程如下：" class="headerlink" title="在Fabric网络启动运行后，我们将使用Fabcar链码进行测试。总体流程如下："></a>在Fabric网络启动运行后，我们将使用Fabcar链码进行测试。总体流程如下：</h2><p>准备4台可以互相通信的主机，均为linu内核。<br>构建一个叠加网络，将4个主机都加入该网络<br>在主机1上准备所有资料，包括密码学资料、通道配置交易、每个节点的docker-compose文件等。然后拷贝到其他主机。<br>使用docker-compose启动所有组件<br>创建通道mychannel并将所有peer加入该通道<br>安装并实例化Fabcar链码<br>调用查询链码方法</p>
<h3 id="使用Docker-Swarm构建叠加网络"><a href="#使用Docker-Swarm构建叠加网络" class="headerlink" title="使用Docker Swarm构建叠加网络"></a>使用Docker Swarm构建叠加网络</h3><ul>
<li><p>在host1初始化swarm集群</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">docker swarm init</div></pre></td></tr></table></figure>
</li>
<li><p>在host1上创建swarm网络</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">docker network create --attachable --driver overlay first-network</div></pre></td></tr></table></figure>
</li>
<li><p>在其余host上（以管理节点的身份）加入swarm网络</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">docker swarm join --token xxxxxxxxxxx</div></pre></td></tr></table></figure>
</li>
<li><p>验证每台host上是否有名称为first-network网络</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">docker network ls</div></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="在host1上准备材料"><a href="#在host1上准备材料" class="headerlink" title="在host1上准备材料"></a>在host1上准备材料</h3><ul>
<li>首先进入fabric-samples目录，如果还没有fabric-samples，自行在github上面去当去该项目，然后创建一个raft-4node-swarm目录。</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">cd fabric-samples</div><div class="line">mkdir raft-4node-swarm</div><div class="line">cd raft-4node-swarm</div></pre></td></tr></table></figure>
<ul>
<li><p>直接从first-network拷贝crypto-config.yaml和configtx.yaml文件</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">cp ../first-network/crypto-config.yaml .</div><div class="line">cp ../first-network/configtx.yaml .</div></pre></td></tr></table></figure>
</li>
<li><p>直接从config拷贝core.yaml和orderer.yaml文件,并修改core.yaml中mspConfigPath内容</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">cp ../config/core.yaml .</div><div class="line">cp ../config/orderer.yaml .</div></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="core-yaml更改前"><a href="#core-yaml更改前" class="headerlink" title="core.yaml更改前"></a>core.yaml更改前</h4><figure class="highlight yaml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># Path on the file system where peer will find MSP local configurations</span></div><div class="line"><span class="attr">   mspConfigPath:</span> <span class="string">msp</span></div></pre></td></tr></table></figure>
<h4 id="core-yaml更改后"><a href="#core-yaml更改后" class="headerlink" title="core.yaml更改后"></a>core.yaml更改后</h4><figure class="highlight yaml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># Path on the file system where peer will find MSP local configurations</span></div><div class="line"><span class="attr">   mspConfigPath:</span> <span class="string">crypto-config/ordererOrganizations/example.com/msp</span></div></pre></td></tr></table></figure>
<ul>
<li>其中 crypto-config.yaml 用于生成MSP相关证书，育有组织架构和节点数和first-network一样，所以不作修改。<br>其中configtx.yaml用于生成创世区块，交易通道配置等，由于节点的通信地址变化，所以共识机制配置中排序节点的通信地址要更改，更改内容如下</li>
</ul>
<h4 id="configtx-yaml更改前："><a href="#configtx-yaml更改前：" class="headerlink" title="configtx.yaml更改前："></a>configtx.yaml更改前：</h4><figure class="highlight yaml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="bullet">-</span> <span class="meta">&amp;Org2</span></div><div class="line">     <span class="comment"># DefaultOrg defines the organization which is used in the sampleconfig</span></div><div class="line">     <span class="comment"># of the fabric.git development environment</span></div><div class="line"><span class="attr">     Name:</span> <span class="string">Org2MSP</span></div><div class="line"></div><div class="line">     <span class="comment"># ID to load the MSP definition as</span></div><div class="line"><span class="attr">     ID:</span> <span class="string">Org2MSP</span></div><div class="line"></div><div class="line"><span class="attr">     MSPDir:</span> <span class="string">crypto-config/peerOrganizations/org2.example.com/msp</span></div><div class="line"></div><div class="line">     <span class="comment"># Policies defines the set of policies at this level of the config tree</span></div><div class="line">     <span class="comment"># For organization policies, their canonical path is usually</span></div><div class="line">     <span class="comment">#   /Channel/&lt;Application|Orderer&gt;/&lt;OrgName&gt;/&lt;PolicyName&gt;</span></div><div class="line"><span class="attr">     Policies:</span></div><div class="line"><span class="attr">         Readers:</span></div><div class="line"><span class="attr">             Type:</span> <span class="string">Signature</span></div><div class="line"><span class="attr">             Rule:</span> <span class="string">"OR('Org2MSP.admin', 'Org2MSP.peer', 'Org2MSP.client')"</span></div><div class="line"><span class="attr">         Writers:</span></div><div class="line"><span class="attr">             Type:</span> <span class="string">Signature</span></div><div class="line"><span class="attr">             Rule:</span> <span class="string">"OR('Org2MSP.admin', 'Org2MSP.client')"</span></div><div class="line"><span class="attr">         Admins:</span></div><div class="line"><span class="attr">             Type:</span> <span class="string">Signature</span></div><div class="line"><span class="attr">             Rule:</span> <span class="string">"OR('Org2MSP.admin')"</span></div><div class="line"><span class="attr">         Endorsement:</span></div><div class="line"><span class="attr">             Type:</span> <span class="string">Signature</span></div><div class="line"><span class="attr">             Rule:</span> <span class="string">"OR('Org2MSP.peer')"</span></div><div class="line"></div><div class="line"><span class="attr">     AnchorPeers:</span></div><div class="line">         <span class="comment"># AnchorPeers defines the location of peers which can be used</span></div><div class="line">         <span class="comment"># for cross org gossip communication.  Note, this value is only</span></div><div class="line">         <span class="comment"># encoded in the genesis block in the Application section context</span></div><div class="line"><span class="attr">         - Host:</span> <span class="string">peer0.org2.example.com</span></div><div class="line"><span class="attr">           Port:</span> <span class="number">9051</span></div><div class="line"></div><div class="line"><span class="attr"> SampleMultiNodeEtcdRaft:</span></div><div class="line">     <span class="string">&lt;&lt;:</span> <span class="meta">*ChannelDefaults</span></div><div class="line"><span class="attr">     Capabilities:</span></div><div class="line">         <span class="string">&lt;&lt;:</span> <span class="meta">*ChannelCapabilities</span></div><div class="line"><span class="attr">     Orderer:</span></div><div class="line">         <span class="string">&lt;&lt;:</span> <span class="meta">*OrdererDefaults</span></div><div class="line"><span class="attr">         OrdererType:</span> <span class="string">etcdraft</span></div><div class="line"><span class="attr">         EtcdRaft:</span></div><div class="line"><span class="attr">             Consenters:</span></div><div class="line"><span class="attr">             - Host:</span> <span class="string">orderer.example.com</span></div><div class="line"><span class="attr">               Port:</span> <span class="number">7050</span></div><div class="line"><span class="attr">               ClientTLSCert:</span> <span class="string">crypto-config/ordererOrganizations/example.com/orderers/orderer.example.com/tls/server.crt</span></div><div class="line"><span class="attr">               ServerTLSCert:</span> <span class="string">crypto-config/ordererOrganizations/example.com/orderers/orderer.example.com/tls/server.crt</span></div><div class="line"><span class="attr">             - Host:</span> <span class="string">orderer2.example.com</span></div><div class="line"><span class="attr">               Port:</span> <span class="number">8050</span></div><div class="line"><span class="attr">               ClientTLSCert:</span> <span class="string">crypto-config/ordererOrganizations/example.com/orderers/orderer2.example.com/tls/server.crt</span></div><div class="line"><span class="attr">               ServerTLSCert:</span> <span class="string">crypto-config/ordererOrganizations/example.com/orderers/orderer2.example.com/tls/server.crt</span></div><div class="line"><span class="attr">             - Host:</span> <span class="string">orderer3.example.com</span></div><div class="line"><span class="attr">               Port:</span> <span class="number">9050</span></div><div class="line"><span class="attr">               ClientTLSCert:</span> <span class="string">crypto-config/ordererOrganizations/example.com/orderers/orderer3.example.com/tls/server.crt</span></div><div class="line"><span class="attr">               ServerTLSCert:</span> <span class="string">crypto-config/ordererOrganizations/example.com/orderers/orderer3.example.com/tls/server.crt</span></div><div class="line"><span class="attr">             - Host:</span> <span class="string">orderer4.example.com</span></div><div class="line"><span class="attr">               Port:</span> <span class="number">10050</span></div><div class="line"><span class="attr">               ClientTLSCert:</span> <span class="string">crypto-config/ordererOrganizations/example.com/orderers/orderer4.example.com/tls/server.crt</span></div><div class="line"><span class="attr">               ServerTLSCert:</span> <span class="string">crypto-config/ordererOrganizations/example.com/orderers/orderer4.example.com/tls/server.crt</span></div><div class="line"><span class="attr">             - Host:</span> <span class="string">orderer5.example.com</span></div><div class="line"><span class="attr">               Port:</span> <span class="number">11050</span></div><div class="line"><span class="attr">               ClientTLSCert:</span> <span class="string">crypto-config/ordererOrganizations/example.com/orderers/orderer5.example.com/tls/server.crt</span></div><div class="line"><span class="attr">               ServerTLSCert:</span> <span class="string">crypto-config/ordererOrganizations/example.com/orderers/orderer5.example.com/tls/server.crt</span></div><div class="line"><span class="attr">         Addresses:</span></div><div class="line"><span class="bullet">             -</span> <span class="string">orderer.example.com:7050</span></div><div class="line"><span class="bullet">             -</span> <span class="string">orderer2.example.com:8050</span></div><div class="line"><span class="bullet">             -</span> <span class="string">orderer3.example.com:9050</span></div><div class="line"><span class="bullet">             -</span> <span class="string">orderer4.example.com:10050</span></div><div class="line"><span class="bullet">             -</span> <span class="string">orderer5.example.com:11050</span></div></pre></td></tr></table></figure>
<h4 id="configtx-yaml更改后："><a href="#configtx-yaml更改后：" class="headerlink" title="configtx.yaml更改后："></a>configtx.yaml更改后：</h4><figure class="highlight yaml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="bullet"> -</span> <span class="meta">&amp;Org2</span></div><div class="line">    <span class="comment"># DefaultOrg defines the organization which is used in the sampleconfig</span></div><div class="line">    <span class="comment"># of the fabric.git development environment</span></div><div class="line"><span class="attr">    Name:</span> <span class="string">Org2MSP</span></div><div class="line"></div><div class="line">    <span class="comment"># ID to load the MSP definition as</span></div><div class="line"><span class="attr">    ID:</span> <span class="string">Org2MSP</span></div><div class="line"></div><div class="line"><span class="attr">    MSPDir:</span> <span class="string">crypto-config/peerOrganizations/org2.example.com/msp</span></div><div class="line"></div><div class="line">    <span class="comment"># Policies defines the set of policies at this level of the config tree</span></div><div class="line">    <span class="comment"># For organization policies, their canonical path is usually</span></div><div class="line">    <span class="comment">#   /Channel/&lt;Application|Orderer&gt;/&lt;OrgName&gt;/&lt;PolicyName&gt;</span></div><div class="line"><span class="attr">    Policies:</span></div><div class="line"><span class="attr">        Readers:</span></div><div class="line"><span class="attr">            Type:</span> <span class="string">Signature</span></div><div class="line"><span class="attr">            Rule:</span> <span class="string">"OR('Org2MSP.admin', 'Org2MSP.peer', 'Org2MSP.client')"</span></div><div class="line"><span class="attr">        Writers:</span></div><div class="line"><span class="attr">            Type:</span> <span class="string">Signature</span></div><div class="line"><span class="attr">            Rule:</span> <span class="string">"OR('Org2MSP.admin', 'Org2MSP.client')"</span></div><div class="line"><span class="attr">        Admins:</span></div><div class="line"><span class="attr">            Type:</span> <span class="string">Signature</span></div><div class="line"><span class="attr">            Rule:</span> <span class="string">"OR('Org2MSP.admin')"</span></div><div class="line"><span class="attr">        Endorsement:</span></div><div class="line"><span class="attr">            Type:</span> <span class="string">Signature</span></div><div class="line"><span class="attr">            Rule:</span> <span class="string">"OR('Org2MSP.peer')"</span></div><div class="line"></div><div class="line"><span class="attr">    AnchorPeers:</span></div><div class="line">        <span class="comment"># AnchorPeers defines the location of peers which can be used</span></div><div class="line">        <span class="comment"># for cross org gossip communication.  Note, this value is only</span></div><div class="line">        <span class="comment"># encoded in the genesis block in the Application section context</span></div><div class="line"><span class="attr">        - Host:</span> <span class="string">peer0.org2.example.com</span></div><div class="line"><span class="attr">          Port:</span> <span class="number">7051</span></div><div class="line"></div><div class="line"><span class="attr">SampleMultiNodeEtcdRaft:</span></div><div class="line">    <span class="string">&lt;&lt;:</span> <span class="meta">*ChannelDefaults</span></div><div class="line"><span class="attr">    Capabilities:</span></div><div class="line">        <span class="string">&lt;&lt;:</span> <span class="meta">*ChannelCapabilities</span></div><div class="line"><span class="attr">    Orderer:</span></div><div class="line">        <span class="string">&lt;&lt;:</span> <span class="meta">*OrdererDefaults</span></div><div class="line"><span class="attr">        OrdererType:</span> <span class="string">etcdraft</span></div><div class="line"><span class="attr">        EtcdRaft:</span></div><div class="line"><span class="attr">            Consenters:</span></div><div class="line"><span class="attr">            - Host:</span> <span class="string">orderer.example.com</span></div><div class="line"><span class="attr">              Port:</span> <span class="number">7050</span></div><div class="line"><span class="attr">              ClientTLSCert:</span> <span class="string">crypto-config/ordererOrganizations/example.com/orderers/orderer.example.com/tls/server.crt</span></div><div class="line"><span class="attr">              ServerTLSCert:</span> <span class="string">crypto-config/ordererOrganizations/example.com/orderers/orderer.example.com/tls/server.crt</span></div><div class="line"><span class="attr">            - Host:</span> <span class="string">orderer2.example.com</span></div><div class="line"><span class="attr">              Port:</span> <span class="number">7050</span></div><div class="line"><span class="attr">              ClientTLSCert:</span> <span class="string">crypto-config/ordererOrganizations/example.com/orderers/orderer2.example.com/tls/server.crt</span></div><div class="line"><span class="attr">              ServerTLSCert:</span> <span class="string">crypto-config/ordererOrganizations/example.com/orderers/orderer2.example.com/tls/server.crt</span></div><div class="line"><span class="attr">            - Host:</span> <span class="string">orderer3.example.com</span></div><div class="line"><span class="attr">              Port:</span> <span class="number">7050</span></div><div class="line"><span class="attr">              ClientTLSCert:</span> <span class="string">crypto-config/ordererOrganizations/example.com/orderers/orderer3.example.com/tls/server.crt</span></div><div class="line"><span class="attr">              ServerTLSCert:</span> <span class="string">crypto-config/ordererOrganizations/example.com/orderers/orderer3.example.com/tls/server.crt</span></div><div class="line"><span class="attr">            - Host:</span> <span class="string">orderer4.example.com</span></div><div class="line"><span class="attr">              Port:</span> <span class="number">7050</span></div><div class="line"><span class="attr">              ClientTLSCert:</span> <span class="string">crypto-config/ordererOrganizations/example.com/orderers/orderer4.example.com/tls/server.crt</span></div><div class="line"><span class="attr">              ServerTLSCert:</span> <span class="string">crypto-config/ordererOrganizations/example.com/orderers/orderer4.example.com/tls/server.crt</span></div><div class="line"><span class="attr">            - Host:</span> <span class="string">orderer5.example.com</span></div><div class="line"><span class="attr">              Port:</span> <span class="number">8050</span></div><div class="line"><span class="attr">              ClientTLSCert:</span> <span class="string">crypto-config/ordererOrganizations/example.com/orderers/orderer5.example.com/tls/server.crt</span></div><div class="line"><span class="attr">              ServerTLSCert:</span> <span class="string">crypto-config/ordererOrganizations/example.com/orderers/orderer5.example.com/tls/server.crt</span></div><div class="line"><span class="attr">        Addresses:</span></div><div class="line"><span class="bullet">            -</span> <span class="string">orderer.example.com:7050</span></div><div class="line"><span class="bullet">            -</span> <span class="string">orderer2.example.com:7050</span></div><div class="line"><span class="bullet">            -</span> <span class="string">orderer3.example.com:7050</span></div><div class="line"><span class="bullet">            -</span> <span class="string">orderer4.example.com:7050</span></div><div class="line"><span class="bullet">            -</span> <span class="string">orderer5.example.com:8050</span></div></pre></td></tr></table></figure>
<h4 id="然后根据配置文件生成必要的密码学资料："><a href="#然后根据配置文件生成必要的密码学资料：" class="headerlink" title="然后根据配置文件生成必要的密码学资料："></a>然后根据配置文件生成必要的密码学资料：</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">../bin/cryptogen generate --config=./crypto-config.yaml</div><div class="line">export FABRIC_CFG_PATH=$PWD</div><div class="line">mkdir channel-artifacts</div><div class="line">../bin/configtxgen -profile SampleMultiNodeEtcdRaft -outputBlock ./channel-artifacts/genesis.block -channelID byfn-sys-channel</div><div class="line">../bin/configtxgen -profile TwoOrgsChannel -outputCreateChannelTx ./channel-artifacts/channel.tx -channelID mychannel</div><div class="line">../bin/configtxgen -profile TwoOrgsChannel -outputAnchorPeersUpdate ./channel-artifacts/Org1MSPanchors.tx -channelID mychannel -asOrg Org1MSP</div><div class="line">../bin/configtxgen -profile TwoOrgsChannel -outputAnchorPeersUpdate ./channel-artifacts/Org2MSPanchors.tx -channelID mychannel -asOrg Org2MSP</div></pre></td></tr></table></figure>
<h4 id="现在我们为所有主机准备docker-compose文件，主要基于BYFN中的文件，需要创建6个docker-compose文件以及一个env文件"><a href="#现在我们为所有主机准备docker-compose文件，主要基于BYFN中的文件，需要创建6个docker-compose文件以及一个env文件" class="headerlink" title="现在我们为所有主机准备docker-compose文件，主要基于BYFN中的文件，需要创建6个docker-compose文件以及一个env文件"></a>现在我们为所有主机准备docker-compose文件，主要基于BYFN中的文件，需要创建6个docker-compose文件以及一个env文件</h4><ul>
<li>base/peer-base.yaml</li>
<li>base/docker-compose-peer.yaml</li>
<li>host1.yaml</li>
<li>host2.yaml</li>
<li>host3.yaml</li>
<li>host4.yaml</li>
<li>.env</li>
</ul>
<h5 id="base-peer-base-yaml-内容："><a href="#base-peer-base-yaml-内容：" class="headerlink" title="base/peer-base.yaml 内容："></a>base/peer-base.yaml 内容：</h5><figure class="highlight yaml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="comment"># Copyright IBM Corp. All Rights Reserved.</span></div><div class="line"><span class="comment">#</span></div><div class="line"><span class="comment"># SPDX-License-Identifier: Apache-2.0</span></div><div class="line"><span class="comment">#</span></div><div class="line"></div><div class="line"><span class="attr">version:</span> <span class="string">'2'</span></div><div class="line"></div><div class="line"><span class="attr">services:</span></div><div class="line"><span class="attr">  peer-base:</span></div><div class="line"><span class="attr">    image:</span> <span class="string">hyperledger/fabric-peer:$IMAGE_TAG</span></div><div class="line"><span class="attr">    environment:</span></div><div class="line"><span class="bullet">      -</span> <span class="string">CORE_VM_ENDPOINT=unix:///host/var/run/docker.sock</span></div><div class="line">      <span class="comment"># the following setting starts chaincode containers on the same</span></div><div class="line">      <span class="comment"># bridge network as the peers</span></div><div class="line">      <span class="comment"># https://docs.docker.com/compose/networking/</span></div><div class="line"><span class="bullet">      -</span> <span class="string">CORE_VM_DOCKER_HOSTCONFIG_NETWORKMODE=first-network</span></div><div class="line"><span class="bullet">      -</span> <span class="string">FABRIC_LOGGING_SPEC=INFO</span></div><div class="line">      <span class="comment">#- FABRIC_LOGGING_SPEC=DEBUG</span></div><div class="line"><span class="bullet">      -</span> <span class="string">CORE_PEER_TLS_ENABLED=true</span></div><div class="line"><span class="bullet">      -</span> <span class="string">CORE_PEER_GOSSIP_USELEADERELECTION=true</span></div><div class="line"><span class="bullet">      -</span> <span class="string">CORE_PEER_GOSSIP_ORGLEADER=false</span></div><div class="line"><span class="bullet">      -</span> <span class="string">CORE_PEER_PROFILE_ENABLED=true</span></div><div class="line"><span class="bullet">      -</span> <span class="string">CORE_PEER_TLS_CERT_FILE=/etc/hyperledger/fabric/tls/server.crt</span></div><div class="line"><span class="bullet">      -</span> <span class="string">CORE_PEER_TLS_KEY_FILE=/etc/hyperledger/fabric/tls/server.key</span></div><div class="line"><span class="bullet">      -</span> <span class="string">CORE_PEER_TLS_ROOTCERT_FILE=/etc/hyperledger/fabric/tls/ca.crt</span></div><div class="line"><span class="attr">    working_dir:</span> <span class="string">/opt/gopath/src/github.com/hyperledger/fabric/peer</span></div><div class="line"><span class="attr">    command:</span> <span class="string">peer</span> <span class="string">node</span> <span class="string">start</span></div><div class="line"></div><div class="line"><span class="attr">  orderer-base:</span></div><div class="line"><span class="attr">    image:</span> <span class="string">hyperledger/fabric-orderer:$IMAGE_TAG</span></div><div class="line"><span class="attr">    environment:</span></div><div class="line"><span class="bullet">      -</span> <span class="string">FABRIC_LOGGING_SPEC=INFO</span></div><div class="line"><span class="bullet">      -</span> <span class="string">ORDERER_GENERAL_LISTENADDRESS=0.0.0.0</span></div><div class="line"><span class="bullet">      -</span> <span class="string">ORDERER_GENERAL_GENESISMETHOD=file</span></div><div class="line"><span class="bullet">      -</span> <span class="string">ORDERER_GENERAL_GENESISFILE=/var/hyperledger/orderer/orderer.genesis.block</span></div><div class="line"><span class="bullet">      -</span> <span class="string">ORDERER_GENERAL_LOCALMSPID=OrdererMSP</span></div><div class="line"><span class="bullet">      -</span> <span class="string">ORDERER_GENERAL_LOCALMSPDIR=/var/hyperledger/orderer/msp</span></div><div class="line">      <span class="comment"># enabled TLS</span></div><div class="line"><span class="bullet">      -</span> <span class="string">ORDERER_GENERAL_TLS_ENABLED=true</span></div><div class="line"><span class="bullet">      -</span> <span class="string">ORDERER_GENERAL_TLS_PRIVATEKEY=/var/hyperledger/orderer/tls/server.key</span></div><div class="line"><span class="bullet">      -</span> <span class="string">ORDERER_GENERAL_TLS_CERTIFICATE=/var/hyperledger/orderer/tls/server.crt</span></div><div class="line"><span class="bullet">      -</span> <span class="string">ORDERER_GENERAL_TLS_ROOTCAS=[/var/hyperledger/orderer/tls/ca.crt]</span></div><div class="line"><span class="bullet">      -</span> <span class="string">ORDERER_KAFKA_TOPIC_REPLICATIONFACTOR=1</span></div><div class="line"><span class="bullet">      -</span> <span class="string">ORDERER_KAFKA_VERBOSE=true</span></div><div class="line"><span class="bullet">      -</span> <span class="string">ORDERER_GENERAL_CLUSTER_CLIENTCERTIFICATE=/var/hyperledger/orderer/tls/server.crt</span></div><div class="line"><span class="bullet">      -</span> <span class="string">ORDERER_GENERAL_CLUSTER_CLIENTPRIVATEKEY=/var/hyperledger/orderer/tls/server.key</span></div><div class="line"><span class="bullet">      -</span> <span class="string">ORDERER_GENERAL_CLUSTER_ROOTCAS=[/var/hyperledger/orderer/tls/ca.crt]</span></div><div class="line"><span class="attr">    working_dir:</span> <span class="string">/opt/gopath/src/github.com/hyperledger/fabric</span></div><div class="line"><span class="attr">    command:</span> <span class="string">orderer</span></div></pre></td></tr></table></figure>
<h5 id="base-docker-compose-base-yaml-内容"><a href="#base-docker-compose-base-yaml-内容" class="headerlink" title="base/docker-compose-base.yaml 内容:"></a>base/docker-compose-base.yaml 内容:</h5><figure class="highlight yaml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="comment"># Copyright IBM Corp. All Rights Reserved.</span></div><div class="line"><span class="comment">#</span></div><div class="line"><span class="comment"># SPDX-License-Identifier: Apache-2.0</span></div><div class="line"><span class="comment">#</span></div><div class="line"></div><div class="line"><span class="attr">version:</span> <span class="string">'2'</span></div><div class="line"></div><div class="line"><span class="attr">services:</span></div><div class="line"></div><div class="line">  <span class="string">orderer.example.com:</span></div><div class="line"><span class="attr">    container_name:</span> <span class="string">orderer.example.com</span></div><div class="line"><span class="attr">    extends:</span></div><div class="line"><span class="attr">      file:</span> <span class="string">peer-base.yaml</span></div><div class="line"><span class="attr">      service:</span> <span class="string">orderer-base</span></div><div class="line"><span class="attr">    volumes:</span></div><div class="line"><span class="bullet">        -</span> <span class="string">../channel-artifacts/genesis.block:/var/hyperledger/orderer/orderer.genesis.block</span></div><div class="line"><span class="bullet">        -</span> <span class="string">../crypto-config/ordererOrganizations/example.com/orderers/orderer.example.com/msp:/var/hyperledger/orderer/msp</span></div><div class="line"><span class="bullet">        -</span> <span class="string">../crypto-config/ordererOrganizations/example.com/orderers/orderer.example.com/tls/:/var/hyperledger/orderer/tls</span></div><div class="line"><span class="bullet">        -</span> <span class="string">orderer.example.com:/var/hyperledger/production/orderer</span></div><div class="line"><span class="attr">    ports:</span></div><div class="line"><span class="bullet">      -</span> <span class="number">7050</span><span class="string">:7050</span></div><div class="line"></div><div class="line">  <span class="string">peer0.org1.example.com:</span></div><div class="line"><span class="attr">    container_name:</span> <span class="string">peer0.org1.example.com</span></div><div class="line"><span class="attr">    extends:</span></div><div class="line"><span class="attr">      file:</span> <span class="string">peer-base.yaml</span></div><div class="line"><span class="attr">      service:</span> <span class="string">peer-base</span></div><div class="line"><span class="attr">    environment:</span></div><div class="line"><span class="bullet">      -</span> <span class="string">CORE_PEER_ID=peer0.org1.example.com</span></div><div class="line"><span class="bullet">      -</span> <span class="string">CORE_PEER_ADDRESS=peer0.org1.example.com:7051</span></div><div class="line"><span class="bullet">      -</span> <span class="string">CORE_PEER_LISTENADDRESS=0.0.0.0:7051</span></div><div class="line"><span class="bullet">      -</span> <span class="string">CORE_PEER_CHAINCODEADDRESS=peer0.org1.example.com:7052</span></div><div class="line"><span class="bullet">      -</span> <span class="string">CORE_PEER_CHAINCODELISTENADDRESS=0.0.0.0:7052</span></div><div class="line"><span class="bullet">      -</span> <span class="string">CORE_PEER_GOSSIP_BOOTSTRAP=peer1.org1.example.com:7051</span></div><div class="line"><span class="bullet">      -</span> <span class="string">CORE_PEER_GOSSIP_EXTERNALENDPOINT=peer0.org1.example.com:7051</span></div><div class="line"><span class="bullet">      -</span> <span class="string">CORE_PEER_LOCALMSPID=Org1MSP</span></div><div class="line"><span class="attr">    volumes:</span></div><div class="line"><span class="bullet">        -</span> <span class="string">/var/run/:/host/var/run/</span></div><div class="line"><span class="bullet">        -</span> <span class="string">../crypto-config/peerOrganizations/org1.example.com/peers/peer0.org1.example.com/msp:/etc/hyperledger/fabric/msp</span></div><div class="line"><span class="bullet">        -</span> <span class="string">../crypto-config/peerOrganizations/org1.example.com/peers/peer0.org1.example.com/tls:/etc/hyperledger/fabric/tls</span></div><div class="line"><span class="bullet">        -</span> <span class="string">peer0.org1.example.com:/var/hyperledger/production</span></div><div class="line"><span class="attr">    ports:</span></div><div class="line"><span class="bullet">      -</span> <span class="number">7051</span><span class="string">:7051</span></div><div class="line"></div><div class="line">  <span class="string">peer1.org1.example.com:</span></div><div class="line"><span class="attr">    container_name:</span> <span class="string">peer1.org1.example.com</span></div><div class="line"><span class="attr">    extends:</span></div><div class="line"><span class="attr">      file:</span> <span class="string">peer-base.yaml</span></div><div class="line"><span class="attr">      service:</span> <span class="string">peer-base</span></div><div class="line"><span class="attr">    environment:</span></div><div class="line"><span class="bullet">      -</span> <span class="string">CORE_PEER_ID=peer1.org1.example.com</span></div><div class="line"><span class="bullet">      -</span> <span class="string">CORE_PEER_ADDRESS=peer1.org1.example.com:7051</span></div><div class="line"><span class="bullet">      -</span> <span class="string">CORE_PEER_LISTENADDRESS=0.0.0.0:7051</span></div><div class="line"><span class="bullet">      -</span> <span class="string">CORE_PEER_CHAINCODEADDRESS=peer1.org1.example.com:7052</span></div><div class="line"><span class="bullet">      -</span> <span class="string">CORE_PEER_CHAINCODELISTENADDRESS=0.0.0.0:7052</span></div><div class="line"><span class="bullet">      -</span> <span class="string">CORE_PEER_GOSSIP_EXTERNALENDPOINT=peer1.org1.example.com:7051</span></div><div class="line"><span class="bullet">      -</span> <span class="string">CORE_PEER_GOSSIP_BOOTSTRAP=peer0.org1.example.com:7051</span></div><div class="line"><span class="bullet">      -</span> <span class="string">CORE_PEER_LOCALMSPID=Org1MSP</span></div><div class="line"><span class="attr">    volumes:</span></div><div class="line"><span class="bullet">        -</span> <span class="string">/var/run/:/host/var/run/</span></div><div class="line"><span class="bullet">        -</span> <span class="string">../crypto-config/peerOrganizations/org1.example.com/peers/peer1.org1.example.com/msp:/etc/hyperledger/fabric/msp</span></div><div class="line"><span class="bullet">        -</span> <span class="string">../crypto-config/peerOrganizations/org1.example.com/peers/peer1.org1.example.com/tls:/etc/hyperledger/fabric/tls</span></div><div class="line"><span class="bullet">        -</span> <span class="string">peer1.org1.example.com:/var/hyperledger/production</span></div><div class="line"><span class="attr">    ports:</span></div><div class="line"><span class="bullet">      -</span> <span class="number">7051</span><span class="string">:7051</span></div><div class="line"></div><div class="line">  <span class="string">peer0.org2.example.com:</span></div><div class="line"><span class="attr">    container_name:</span> <span class="string">peer0.org2.example.com</span></div><div class="line"><span class="attr">    extends:</span></div><div class="line"><span class="attr">      file:</span> <span class="string">peer-base.yaml</span></div><div class="line"><span class="attr">      service:</span> <span class="string">peer-base</span></div><div class="line"><span class="attr">    environment:</span></div><div class="line"><span class="bullet">      -</span> <span class="string">CORE_PEER_ID=peer0.org2.example.com</span></div><div class="line"><span class="bullet">      -</span> <span class="string">CORE_PEER_ADDRESS=peer0.org2.example.com:7051</span></div><div class="line"><span class="bullet">      -</span> <span class="string">CORE_PEER_LISTENADDRESS=0.0.0.0:7051</span></div><div class="line"><span class="bullet">      -</span> <span class="string">CORE_PEER_CHAINCODEADDRESS=peer0.org2.example.com:7052</span></div><div class="line"><span class="bullet">      -</span> <span class="string">CORE_PEER_CHAINCODELISTENADDRESS=0.0.0.0:7052</span></div><div class="line"><span class="bullet">      -</span> <span class="string">CORE_PEER_GOSSIP_EXTERNALENDPOINT=peer0.org2.example.com:7051</span></div><div class="line"><span class="bullet">      -</span> <span class="string">CORE_PEER_GOSSIP_BOOTSTRAP=peer1.org2.example.com:7051</span></div><div class="line"><span class="bullet">      -</span> <span class="string">CORE_PEER_LOCALMSPID=Org2MSP</span></div><div class="line"><span class="attr">    volumes:</span></div><div class="line"><span class="bullet">        -</span> <span class="string">/var/run/:/host/var/run/</span></div><div class="line"><span class="bullet">        -</span> <span class="string">../crypto-config/peerOrganizations/org2.example.com/peers/peer0.org2.example.com/msp:/etc/hyperledger/fabric/msp</span></div><div class="line"><span class="bullet">        -</span> <span class="string">../crypto-config/peerOrganizations/org2.example.com/peers/peer0.org2.example.com/tls:/etc/hyperledger/fabric/tls</span></div><div class="line"><span class="bullet">        -</span> <span class="string">peer0.org2.example.com:/var/hyperledger/production</span></div><div class="line"><span class="attr">    ports:</span></div><div class="line"><span class="bullet">      -</span> <span class="number">7051</span><span class="string">:7051</span></div><div class="line"></div><div class="line">  <span class="string">peer1.org2.example.com:</span></div><div class="line"><span class="attr">    container_name:</span> <span class="string">peer1.org2.example.com</span></div><div class="line"><span class="attr">    extends:</span></div><div class="line"><span class="attr">      file:</span> <span class="string">peer-base.yaml</span></div><div class="line"><span class="attr">      service:</span> <span class="string">peer-base</span></div><div class="line"><span class="attr">    environment:</span></div><div class="line"><span class="bullet">      -</span> <span class="string">CORE_PEER_ID=peer1.org2.example.com</span></div><div class="line"><span class="bullet">      -</span> <span class="string">CORE_PEER_ADDRESS=peer1.org2.example.com:7051</span></div><div class="line"><span class="bullet">      -</span> <span class="string">CORE_PEER_LISTENADDRESS=0.0.0.0:7051</span></div><div class="line"><span class="bullet">      -</span> <span class="string">CORE_PEER_CHAINCODEADDRESS=peer1.org2.example.com:7052</span></div><div class="line"><span class="bullet">      -</span> <span class="string">CORE_PEER_CHAINCODELISTENADDRESS=0.0.0.0:7052</span></div><div class="line"><span class="bullet">      -</span> <span class="string">CORE_PEER_GOSSIP_EXTERNALENDPOINT=peer1.org2.example.com:7051</span></div><div class="line"><span class="bullet">      -</span> <span class="string">CORE_PEER_GOSSIP_BOOTSTRAP=peer0.org2.example.com:7051</span></div><div class="line"><span class="bullet">      -</span> <span class="string">CORE_PEER_LOCALMSPID=Org2MSP</span></div><div class="line"><span class="attr">    volumes:</span></div><div class="line"><span class="bullet">        -</span> <span class="string">/var/run/:/host/var/run/</span></div><div class="line"><span class="bullet">        -</span> <span class="string">../crypto-config/peerOrganizations/org2.example.com/peers/peer1.org2.example.com/msp:/etc/hyperledger/fabric/msp</span></div><div class="line"><span class="bullet">        -</span> <span class="string">../crypto-config/peerOrganizations/org2.example.com/peers/peer1.org2.example.com/tls:/etc/hyperledger/fabric/tls</span></div><div class="line"><span class="bullet">        -</span> <span class="string">peer1.org2.example.com:/var/hyperledger/production</span></div><div class="line"><span class="attr">    ports:</span></div><div class="line"><span class="bullet">      -</span> <span class="number">7051</span><span class="string">:7051</span></div></pre></td></tr></table></figure>
<h5 id="host1-yaml-内容"><a href="#host1-yaml-内容" class="headerlink" title="host1.yaml 内容:"></a>host1.yaml 内容:</h5><figure class="highlight yaml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="comment"># Copyright IBM Corp. All Rights Reserved.</span></div><div class="line"><span class="comment">#</span></div><div class="line"><span class="comment"># SPDX-License-Identifier: Apache-2.0</span></div><div class="line"><span class="comment">#</span></div><div class="line"></div><div class="line"><span class="attr">version:</span> <span class="string">'2'</span></div><div class="line"></div><div class="line"><span class="attr">volumes:</span></div><div class="line">  <span class="string">orderer.example.com:</span></div><div class="line">  <span class="string">orderer5.example.com:</span></div><div class="line">  <span class="string">peer0.org1.example.com:</span></div><div class="line"></div><div class="line"><span class="attr">networks:</span></div><div class="line"><span class="attr">  byfn:</span></div><div class="line"><span class="attr">    external:</span></div><div class="line"><span class="attr">      name:</span> <span class="string">first-network</span></div><div class="line"></div><div class="line"><span class="attr">services:</span></div><div class="line"></div><div class="line">  <span class="string">orderer.example.com:</span></div><div class="line"><span class="attr">    extends:</span></div><div class="line"><span class="attr">      file:</span>   <span class="string">base/docker-compose-base.yaml</span></div><div class="line"><span class="attr">      service:</span> <span class="string">orderer.example.com</span></div><div class="line"><span class="attr">    container_name:</span> <span class="string">orderer.example.com</span></div><div class="line"><span class="attr">    networks:</span></div><div class="line"><span class="bullet">      -</span> <span class="string">byfn</span></div><div class="line"></div><div class="line">  <span class="string">orderer5.example.com:</span></div><div class="line"><span class="attr">    extends:</span></div><div class="line"><span class="attr">      file:</span> <span class="string">base/peer-base.yaml</span></div><div class="line"><span class="attr">      service:</span> <span class="string">orderer-base</span></div><div class="line"><span class="attr">    environment:</span></div><div class="line"><span class="bullet">      -</span> <span class="string">ORDERER_GENERAL_LISTENPORT=7050</span></div><div class="line"><span class="attr">    container_name:</span> <span class="string">orderer5.example.com</span></div><div class="line"><span class="attr">    networks:</span></div><div class="line"><span class="bullet">    -</span> <span class="string">byfn</span></div><div class="line"><span class="attr">    volumes:</span></div><div class="line"><span class="bullet">        -</span> <span class="string">./channel-artifacts/genesis.block:/var/hyperledger/orderer/orderer.genesis.block</span></div><div class="line"><span class="bullet">        -</span> <span class="string">./crypto-config/ordererOrganizations/example.com/orderers/orderer5.example.com/msp:/var/hyperledger/orderer/msp</span></div><div class="line"><span class="bullet">        -</span> <span class="string">./crypto-config/ordererOrganizations/example.com/orderers/orderer5.example.com/tls/:/var/hyperledger/orderer/tls</span></div><div class="line"><span class="bullet">        -</span> <span class="string">orderer5.example.com:/var/hyperledger/production/orderer</span></div><div class="line"><span class="attr">    ports:</span></div><div class="line"><span class="bullet">    -</span> <span class="number">8050</span><span class="string">:7050</span></div><div class="line"></div><div class="line">  <span class="string">peer0.org1.example.com:</span></div><div class="line"><span class="attr">    container_name:</span> <span class="string">peer0.org1.example.com</span></div><div class="line"><span class="attr">    extends:</span></div><div class="line"><span class="attr">      file:</span>  <span class="string">base/docker-compose-base.yaml</span></div><div class="line"><span class="attr">      service:</span> <span class="string">peer0.org1.example.com</span></div><div class="line"><span class="attr">    networks:</span></div><div class="line"><span class="bullet">      -</span> <span class="string">byfn</span></div><div class="line"></div><div class="line"><span class="attr">  cli:</span></div><div class="line"><span class="attr">    container_name:</span> <span class="string">cli</span></div><div class="line"><span class="attr">    image:</span> <span class="string">hyperledger/fabric-tools:$IMAGE_TAG</span></div><div class="line"><span class="attr">    tty:</span> <span class="literal">true</span></div><div class="line"><span class="attr">    stdin_open:</span> <span class="literal">true</span></div><div class="line"><span class="attr">    environment:</span></div><div class="line"><span class="bullet">      -</span> <span class="string">SYS_CHANNEL=$SYS_CHANNEL</span></div><div class="line"><span class="bullet">      -</span> <span class="string">GOPATH=/opt/gopath</span></div><div class="line"><span class="bullet">      -</span> <span class="string">CORE_VM_ENDPOINT=unix:///host/var/run/docker.sock</span></div><div class="line">      <span class="comment">#- FABRIC_LOGGING_SPEC=DEBUG</span></div><div class="line"><span class="bullet">      -</span> <span class="string">FABRIC_LOGGING_SPEC=INFO</span></div><div class="line"><span class="bullet">      -</span> <span class="string">CORE_PEER_ID=cli</span></div><div class="line"><span class="bullet">      -</span> <span class="string">CORE_PEER_ADDRESS=peer0.org1.example.com:7051</span></div><div class="line"><span class="bullet">      -</span> <span class="string">CORE_PEER_LOCALMSPID=Org1MSP</span></div><div class="line"><span class="bullet">      -</span> <span class="string">CORE_PEER_TLS_ENABLED=true</span></div><div class="line"><span class="bullet">      -</span> <span class="string">CORE_PEER_TLS_CERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.example.com/peers/peer0.org1.example.com/tls/server.crt</span></div><div class="line"><span class="bullet">      -</span> <span class="string">CORE_PEER_TLS_KEY_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.example.com/peers/peer0.org1.example.com/tls/server.key</span></div><div class="line"><span class="bullet">      -</span> <span class="string">CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.example.com/peers/peer0.org1.example.com/tls/ca.crt</span></div><div class="line"><span class="bullet">      -</span> <span class="string">CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.example.com/users/Admin@org1.example.com/msp</span></div><div class="line"><span class="attr">    working_dir:</span> <span class="string">/opt/gopath/src/github.com/hyperledger/fabric/peer</span></div><div class="line"><span class="attr">    command:</span> <span class="string">/bin/bash</span></div><div class="line"><span class="attr">    volumes:</span></div><div class="line"><span class="bullet">        -</span> <span class="string">/var/run/:/host/var/run/</span></div><div class="line"><span class="bullet">        -</span> <span class="string">./../chaincode/:/opt/gopath/src/github.com/chaincode</span></div><div class="line"><span class="bullet">        -</span> <span class="string">./crypto-config:/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/</span></div><div class="line"><span class="bullet">        -</span> <span class="string">./scripts:/opt/gopath/src/github.com/hyperledger/fabric/peer/scripts/</span></div><div class="line"><span class="bullet">        -</span> <span class="string">./channel-artifacts:/opt/gopath/src/github.com/hyperledger/fabric/peer/channel-artifacts</span></div><div class="line"><span class="attr">    depends_on:</span></div><div class="line"><span class="bullet">      -</span> <span class="string">orderer.example.com</span></div><div class="line"><span class="bullet">      -</span> <span class="string">peer0.org1.example.com</span></div><div class="line"><span class="attr">    networks:</span></div><div class="line"><span class="bullet">      -</span> <span class="string">byfn</span></div></pre></td></tr></table></figure>
<h5 id="host2-yaml-内容"><a href="#host2-yaml-内容" class="headerlink" title="host2.yaml 内容:"></a>host2.yaml 内容:</h5><figure class="highlight yaml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="comment"># Copyright IBM Corp. All Rights Reserved.</span></div><div class="line"><span class="comment">#</span></div><div class="line"><span class="comment"># SPDX-License-Identifier: Apache-2.0</span></div><div class="line"><span class="comment">#</span></div><div class="line"></div><div class="line"><span class="attr">version:</span> <span class="string">'2'</span></div><div class="line"></div><div class="line"><span class="attr">volumes:</span></div><div class="line">  <span class="string">orderer2.example.com:</span></div><div class="line">  <span class="string">peer1.org1.example.com:</span></div><div class="line"></div><div class="line"><span class="attr">networks:</span></div><div class="line"><span class="attr">  byfn:</span></div><div class="line"><span class="attr">    external:</span></div><div class="line"><span class="attr">      name:</span> <span class="string">first-network</span></div><div class="line"></div><div class="line"><span class="attr">services:</span></div><div class="line"></div><div class="line">  <span class="string">orderer2.example.com:</span></div><div class="line"><span class="attr">    extends:</span></div><div class="line"><span class="attr">      file:</span> <span class="string">base/peer-base.yaml</span></div><div class="line"><span class="attr">      service:</span> <span class="string">orderer-base</span></div><div class="line"><span class="attr">    container_name:</span> <span class="string">orderer2.example.com</span></div><div class="line"><span class="attr">    networks:</span></div><div class="line"><span class="bullet">    -</span> <span class="string">byfn</span></div><div class="line"><span class="attr">    volumes:</span></div><div class="line"><span class="bullet">        -</span> <span class="string">./channel-artifacts/genesis.block:/var/hyperledger/orderer/orderer.genesis.block</span></div><div class="line"><span class="bullet">        -</span> <span class="string">./crypto-config/ordererOrganizations/example.com/orderers/orderer2.example.com/msp:/var/hyperledger/orderer/msp</span></div><div class="line"><span class="bullet">        -</span> <span class="string">./crypto-config/ordererOrganizations/example.com/orderers/orderer2.example.com/tls/:/var/hyperledger/orderer/tls</span></div><div class="line"><span class="bullet">        -</span> <span class="string">orderer2.example.com:/var/hyperledger/production/orderer</span></div><div class="line"><span class="attr">    ports:</span></div><div class="line"><span class="bullet">    -</span> <span class="number">7050</span><span class="string">:7050</span></div><div class="line"></div><div class="line">  <span class="string">peer1.org1.example.com:</span></div><div class="line"><span class="attr">    container_name:</span> <span class="string">peer1.org1.example.com</span></div><div class="line"><span class="attr">    extends:</span></div><div class="line"><span class="attr">      file:</span>  <span class="string">base/docker-compose-base.yaml</span></div><div class="line"><span class="attr">      service:</span> <span class="string">peer1.org1.example.com</span></div><div class="line"><span class="attr">    networks:</span></div><div class="line"><span class="bullet">      -</span> <span class="string">byfn</span></div></pre></td></tr></table></figure>
<h5 id="host3-yaml-内容"><a href="#host3-yaml-内容" class="headerlink" title="host3.yaml 内容:"></a>host3.yaml 内容:</h5><figure class="highlight yaml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="comment"># Copyright IBM Corp. All Rights Reserved.</span></div><div class="line"><span class="comment">#</span></div><div class="line"><span class="comment"># SPDX-License-Identifier: Apache-2.0</span></div><div class="line"><span class="comment">#</span></div><div class="line"></div><div class="line"><span class="attr">version:</span> <span class="string">'2'</span></div><div class="line"></div><div class="line"><span class="attr">volumes:</span></div><div class="line">  <span class="string">orderer3.example.com:</span>  </div><div class="line">  <span class="string">peer0.org2.example.com:</span></div><div class="line"></div><div class="line"><span class="attr">networks:</span></div><div class="line"><span class="attr">  byfn:</span></div><div class="line"><span class="attr">    external:</span></div><div class="line"><span class="attr">      name:</span> <span class="string">first-network</span></div><div class="line"></div><div class="line"><span class="attr">services:</span></div><div class="line"></div><div class="line">  <span class="string">orderer3.example.com:</span></div><div class="line"><span class="attr">    extends:</span></div><div class="line"><span class="attr">      file:</span> <span class="string">base/peer-base.yaml</span></div><div class="line"><span class="attr">      service:</span> <span class="string">orderer-base</span></div><div class="line"><span class="attr">    container_name:</span> <span class="string">orderer3.example.com</span></div><div class="line"><span class="attr">    networks:</span></div><div class="line"><span class="bullet">    -</span> <span class="string">byfn</span></div><div class="line"><span class="attr">    volumes:</span></div><div class="line"><span class="bullet">        -</span> <span class="string">./channel-artifacts/genesis.block:/var/hyperledger/orderer/orderer.genesis.block</span></div><div class="line"><span class="bullet">        -</span> <span class="string">./crypto-config/ordererOrganizations/example.com/orderers/orderer3.example.com/msp:/var/hyperledger/orderer/msp</span></div><div class="line"><span class="bullet">        -</span> <span class="string">./crypto-config/ordererOrganizations/example.com/orderers/orderer3.example.com/tls/:/var/hyperledger/orderer/tls</span></div><div class="line"><span class="bullet">        -</span> <span class="string">orderer3.example.com:/var/hyperledger/production/orderer</span></div><div class="line"><span class="attr">    ports:</span></div><div class="line"><span class="bullet">    -</span> <span class="number">7050</span><span class="string">:7050</span></div><div class="line"></div><div class="line">  <span class="string">peer0.org2.example.com:</span></div><div class="line"><span class="attr">    container_name:</span> <span class="string">peer0.org2.example.com</span></div><div class="line"><span class="attr">    extends:</span></div><div class="line"><span class="attr">      file:</span>  <span class="string">base/docker-compose-base.yaml</span></div><div class="line"><span class="attr">      service:</span> <span class="string">peer0.org2.example.com</span></div><div class="line"><span class="attr">    networks:</span></div><div class="line"><span class="bullet">      -</span> <span class="string">byfn</span></div></pre></td></tr></table></figure>
<h5 id="host4-yaml-内容"><a href="#host4-yaml-内容" class="headerlink" title="host4.yaml 内容:"></a>host4.yaml 内容:</h5><figure class="highlight yaml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="comment"># Copyright IBM Corp. All Rights Reserved.</span></div><div class="line"><span class="comment">#</span></div><div class="line"><span class="comment"># SPDX-License-Identifier: Apache-2.0</span></div><div class="line"><span class="comment">#</span></div><div class="line"></div><div class="line"><span class="attr">version:</span> <span class="string">'2'</span></div><div class="line"></div><div class="line"><span class="attr">volumes:</span></div><div class="line">  <span class="string">orderer4.example.com:</span></div><div class="line">  <span class="string">peer1.org2.example.com:</span></div><div class="line"></div><div class="line"><span class="attr">networks:</span></div><div class="line"><span class="attr">  byfn:</span></div><div class="line"><span class="attr">    external:</span></div><div class="line"><span class="attr">      name:</span> <span class="string">first-network</span></div><div class="line"></div><div class="line"><span class="attr">services:</span></div><div class="line"></div><div class="line">  <span class="string">orderer4.example.com:</span></div><div class="line"><span class="attr">    extends:</span></div><div class="line"><span class="attr">      file:</span> <span class="string">base/peer-base.yaml</span></div><div class="line"><span class="attr">      service:</span> <span class="string">orderer-base</span></div><div class="line"><span class="attr">    container_name:</span> <span class="string">orderer4.example.com</span></div><div class="line"><span class="attr">    networks:</span></div><div class="line"><span class="bullet">    -</span> <span class="string">byfn</span></div><div class="line"><span class="attr">    volumes:</span></div><div class="line"><span class="bullet">        -</span> <span class="string">./channel-artifacts/genesis.block:/var/hyperledger/orderer/orderer.genesis.block</span></div><div class="line"><span class="bullet">        -</span> <span class="string">./crypto-config/ordererOrganizations/example.com/orderers/orderer4.example.com/msp:/var/hyperledger/orderer/msp</span></div><div class="line"><span class="bullet">        -</span> <span class="string">./crypto-config/ordererOrganizations/example.com/orderers/orderer4.example.com/tls/:/var/hyperledger/orderer/tls</span></div><div class="line"><span class="bullet">        -</span> <span class="string">orderer4.example.com:/var/hyperledger/production/orderer</span></div><div class="line"><span class="attr">    ports:</span></div><div class="line"><span class="bullet">    -</span> <span class="number">7050</span><span class="string">:7050</span></div><div class="line"></div><div class="line">  <span class="string">peer1.org2.example.com:</span></div><div class="line"><span class="attr">    container_name:</span> <span class="string">peer1.org2.example.com</span></div><div class="line"><span class="attr">    extends:</span></div><div class="line"><span class="attr">      file:</span>  <span class="string">base/docker-compose-base.yaml</span></div><div class="line"><span class="attr">      service:</span> <span class="string">peer1.org2.example.com</span></div><div class="line"><span class="attr">    networks:</span></div><div class="line"><span class="bullet">      -</span> <span class="string">byfn</span></div></pre></td></tr></table></figure>
<h5 id="env-（项目环境配置文件）内容"><a href="#env-（项目环境配置文件）内容" class="headerlink" title=".env （项目环境配置文件）内容"></a>.env （项目环境配置文件）内容</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">COMPOSE_PROJECT_NAME=net</div><div class="line">IMAGE_TAG=latest</div><div class="line">SYS_CHANNEL=byfn-sys-channel</div></pre></td></tr></table></figure>
<h4 id="以上文件具体是针对BYFN中的文件所作的修改总结"><a href="#以上文件具体是针对BYFN中的文件所作的修改总结" class="headerlink" title="以上文件具体是针对BYFN中的文件所作的修改总结"></a>以上文件具体是针对BYFN中的文件所作的修改总结</h4><ul>
<li>base/peer-base.yaml中，CORE_VM_DOCKER_HOSTCONFIG_NETWORKMODE修改为<br>我们之前创建的叠加网络first-network</li>
<li>base/docker-compose-base.yaml中，由于所有的peers都在不同的主机上，我们<br>将端口映射改回7051:7051。在每个peer的环境变量中也进行了相应的修改。</li>
<li>在所有的hostn.yaml文件中，我们添加叠加网络first-network</li>
</ul>
<h4 id="拷贝材料到其余机器"><a href="#拷贝材料到其余机器" class="headerlink" title="拷贝材料到其余机器"></a>拷贝材料到其余机器</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">cd ..</div><div class="line">tar cf raft-4node-swarm.tar raft-4node-swarm</div><div class="line">scp raft-4node-swarm.tar root@192.168.1.25:/root/go/src/github.com/hyperledger/fabric-samples</div><div class="line">scp raft-4node-swarm.tar root@192.168.1.27:/root/go/src/github.com/hyperledger/fabric-samples</div><div class="line">scp raft-4node-swarm.tar root@192.168.1.28:/root/go/src/github.com/hyperledger/fabric-samples</div></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="meta">#</span>在host1、host2、host3上分别执行</div><div class="line">cd /root/go/src/github.com/hyperledger/fabric-samples</div><div class="line">rm -rf raft-4node-swarm</div><div class="line">tar xf raft-4node-swarm.tar</div><div class="line">cd raft-4node-swarm</div></pre></td></tr></table></figure>
<h4 id="分别启动各主机上的容器"><a href="#分别启动各主机上的容器" class="headerlink" title="分别启动各主机上的容器"></a>分别启动各主机上的容器</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="meta">#</span> on Host 1, 2, 3 and 4, bring up corresponding yaml file</div><div class="line">docker-compose -f hostn.yaml up -d</div></pre></td></tr></table></figure>
<h4 id="为mychannel通道创建创世区块"><a href="#为mychannel通道创建创世区块" class="headerlink" title="为mychannel通道创建创世区块"></a>为mychannel通道创建创世区块</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">docker exec cli peer channel create -o orderer.example.com:7050 -c mychannel \</div><div class="line">       -f ./channel-artifacts/channel.tx --tls true \</div><div class="line">       --cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem</div></pre></td></tr></table></figure>
<h4 id="将peer0-org1加入mychannel"><a href="#将peer0-org1加入mychannel" class="headerlink" title="将peer0.org1加入mychannel"></a>将peer0.org1加入mychannel</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">docker exec cli peer channel join -b mychannel.block</div></pre></td></tr></table></figure>
<h4 id="将peer1-org1加入mychannel"><a href="#将peer1-org1加入mychannel" class="headerlink" title="将peer1.org1加入mychannel"></a>将peer1.org1加入mychannel</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">docker exec -e CORE_PEER_ADDRESS=peer1.org1.example.com:7051 \</div><div class="line">       -e CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.example.com/peers/peer1.org1.example.com/tls/ca.crt \</div><div class="line">       cli peer channel join -b mychannel.block</div></pre></td></tr></table></figure>
<h4 id="将peer0-org2加入mychannel"><a href="#将peer0-org2加入mychannel" class="headerlink" title="将peer0.org2加入mychannel"></a>将peer0.org2加入mychannel</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">docker exec -e CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.example.com/users/Admin@org2.example.com/msp \</div><div class="line">       -e CORE_PEER_ADDRESS=peer0.org2.example.com:7051 -e CORE_PEER_LOCALMSPID="Org2MSP" \</div><div class="line">       -e CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.example.com/peers/peer0.org2.example.com/tls/ca.crt \</div><div class="line">       cli peer channel join -b mychannel.block</div></pre></td></tr></table></figure>
<h4 id="将peer1-org2加入mychannel"><a href="#将peer1-org2加入mychannel" class="headerlink" title="将peer1.org2加入mychannel"></a>将peer1.org2加入mychannel</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">docker exec -e CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.example.com/users/Admin@org2.example.com/msp \</div><div class="line">       -e CORE_PEER_ADDRESS=peer1.org2.example.com:7051 -e CORE_PEER_LOCALMSPID="Org2MSP" \</div><div class="line">       -e CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.example.com/peers/peer1.org2.example.com/tls/ca.crt \</div><div class="line">       cli peer channel join -b mychannel.block</div></pre></td></tr></table></figure>
<h4 id="安装并实例化Fabcar链码"><a href="#安装并实例化Fabcar链码" class="headerlink" title="安装并实例化Fabcar链码"></a>安装并实例化Fabcar链码</h4><p>进入到docker的cli终端<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">docker exec -it cli bash</div></pre></td></tr></table></figure></p>
<p>查看当前cli容器环境变量<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">env</div></pre></td></tr></table></figure></p>
<p>正常会显示 CORE_PEER_LOCALMSPID=Org1MSP，表示以org1MSP身份操作</p>
<h4 id="打包合约"><a href="#打包合约" class="headerlink" title="打包合约"></a>打包合约</h4><p>在cli容器内部执行<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">peer lifecycle chaincode package mycc1.tar.gz --path /opt/gopath/src/github.com/chaincode/abstore/go/ --lang golang --label mycc_1</div><div class="line"></div><div class="line"><span class="meta">#</span> mycc1.tar.gz ：打包合约包文件名 </div><div class="line"><span class="meta">#</span> --path 智能合约路径,可以在host1.yaml中查看cli容器的数据卷配置查询</div><div class="line"><span class="meta">#</span> --lang 智能合约语言 支持golang、node、java</div><div class="line"><span class="meta">#</span> --label  智能合约标签，描述作用</div></pre></td></tr></table></figure></p>
<p>执行完成后，查看当前目录，会出现mycc1.tar.gz</p>
<h4 id="部署合约到节点"><a href="#部署合约到节点" class="headerlink" title="部署合约到节点"></a>部署合约到节点</h4><p>继续在cli内部执行以下命令,执行安装合约<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">peer lifecycle chaincode install mycc1.tar.gz</div></pre></td></tr></table></figure></p>
<p>验证合约安装是否安装到节点<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">peer lifecycle chaincode queryinstalled</div></pre></td></tr></table></figure></p>
<p>注意: 显示所有安装的合约包，记录label为mycc1的 Package ID</p>
<h4 id="当前组织同意合约定义"><a href="#当前组织同意合约定义" class="headerlink" title="当前组织同意合约定义"></a>当前组织同意合约定义</h4><p>2.0智能合约由合约定义控制。当通道成员批准合约定义时，该批准作为组织对其接受的合约参数的投票。这些经过批准的组织定义允许通道成员在链码在通道上使用之前对链码达成一致。链码定义包括以下参数，这些参数需要在组织之间保持一致:</p>
<p>名称: 智能合约名称<br>版本: 与给定的合约包相关联的版本号或值。如果您升级了合约二进制文件，那么您也需要更改合约版本。<br>序列: 定义链码的次数。此值为整数，用于跟踪合约升级。例如，当您第一次安装并批准一个chaincode定义时，序列号将是1。下次升级合约时，序列号将增加到2。<br>背书策略: 哪些组织需要执行和验证事务输出。背书策略可以表示为传递给CLI或SDK的字符串，也可以在通道配置中引用策略。默认情况下，背书策略被设置为通道/应用程序/背书，这默认要求通道中的大多数组织对交易进行背书。<br>集合配置: 指向与您的chaincode关联的私有数据集合定义文件的路径。有关私有数据收集的更多信息，请参见私有数据体系结构参考。<br>初始化: 所有的链码需要包含一个初始化函数来初始化链码。默认情况下，这个函数永远不会执行。但是，您可以使用chaincode定义来请求Init函数是可调用的。如果请求执行Init，则fabric将确保在调用任何其他函数之前调用Init，并且只调用一次。<br>ESCC/VSCC插件: 自定义认证或验证插件的名称。</p>
<p>cli容器输入以下命令<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">peer lifecycle chaincode approveformyorg --tls true \</div><div class="line"> --cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem \</div><div class="line"> --channelID mychannel --name mycc1 --version 1 --init-required --package-id mycc_1:aa699dad960f7244415b3133713bb5222657382e1694c926f175bf177f573737 --sequence 1 --waitForEvent</div><div class="line"></div><div class="line"><span class="meta">#</span> --tls 是否启动tls</div><div class="line"><span class="meta">#</span> --ca ca证书路径</div><div class="line"><span class="meta">#</span> --channelID 智能合约安装通道</div><div class="line"><span class="meta">#</span> --name 合约名</div><div class="line"><span class="meta">#</span> --version 合约版本</div><div class="line"><span class="meta">#</span> --package-id queryinstalled查询的合约ID</div><div class="line"><span class="meta">#</span> --sequence 序列号</div><div class="line"><span class="meta">#</span> --waitForEvent 等待peer提交交易返回</div><div class="line"><span class="meta">#</span> --init-required 合约是否必须执行init</div></pre></td></tr></table></figure></p>
<h4 id="检查合约定义是否满足策略"><a href="#检查合约定义是否满足策略" class="headerlink" title="检查合约定义是否满足策略"></a>检查合约定义是否满足策略</h4><p>2.0的智能合约的部署必须满足一定合约定义策略，策略的定义在通道配置中具体定义<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">peer lifecycle chaincode checkcommitreadiness --channelID mychannel --name mycc1  --version 1 --sequence 1 --output json --init-required</div></pre></td></tr></table></figure></p>
<p>输出以下结果<br><figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="attr">"approvals"</span>: &#123;</div><div class="line">    <span class="attr">"Org1MSP"</span>: <span class="literal">true</span>,</div><div class="line">    <span class="attr">"Org2MSP"</span>: <span class="literal">false</span></div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>原因是lifecycle策略定义是满足过半数即可<br>这时候我们需要把Org2MSP也同意这个合约定义，切换环境变量为peer0.org2.example.com的配置</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">export CORE_PEER_LOCALMSPID=Org2MSP</div><div class="line">export CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.example.com/peers/peer0.org2.example.com/tls/ca.crt</div><div class="line">export CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.example.com/users/Admin@org2.example.com/msp</div><div class="line">export CORE_PEER_ADDRESS=peer0.org2.example.com:7051</div></pre></td></tr></table></figure>
<p>以Org2MSP身份执行</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">peer lifecycle chaincode install mycc1.tar.gz</div><div class="line">peer lifecycle chaincode queryinstalled</div><div class="line"></div><div class="line"><span class="meta">#</span> 注意: 显示所有安装的合约包，记录label为mycc1的 Package ID</div></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">peer lifecycle chaincode approveformyorg --tls true \</div><div class="line"> --cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem \</div><div class="line"> --channelID mychannel --name mycc1 --version 1 --init-required --package-id mycc_1:aa699dad960f7244415b3133713bb5222657382e1694c926f175bf177f573737 --sequence 1 --waitForEvent</div><div class="line"></div><div class="line"> peer lifecycle chaincode checkcommitreadiness --channelID mychannel --name mycc1  --version 1 --sequence 1 --output json --init-required</div></pre></td></tr></table></figure>
<p>输出以下结果<br><figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="attr">"approvals"</span>: &#123;</div><div class="line">    <span class="attr">"Org1MSP"</span>: <span class="literal">true</span>,</div><div class="line">    <span class="attr">"Org2MSP"</span>: <span class="literal">true</span></div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h4 id="提交合约"><a href="#提交合约" class="headerlink" title="提交合约"></a>提交合约</h4><p>在满足合约定义的策略后，可以提交合约<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">peer lifecycle chaincode commit -o orderer.example.com:7050 \</div><div class="line"> --tls true --cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem \</div><div class="line"> --channelID mychannel --name mycc1 --peerAddresses peer0.org1.example.com:7051 \</div><div class="line"> --tlsRootCertFiles /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.example.com/peers/peer0.org1.example.com/tls/ca.crt \</div><div class="line"> --peerAddresses peer0.org2.example.com:7051 --tlsRootCertFiles /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.example.com/peers/peer0.org2.example.com/tls/ca.crt \</div><div class="line"> --version 1 --sequence 1 --init-required</div><div class="line"></div><div class="line"></div><div class="line"><span class="meta">#</span> --tls 是否启动tls</div><div class="line"><span class="meta">#</span> --ca ca证书路径</div><div class="line"><span class="meta">#</span> --channelID 智能合约安装通道</div><div class="line"><span class="meta">#</span> --name 合约名</div><div class="line"><span class="meta">#</span> --version 合约版本</div><div class="line"><span class="meta">#</span> --package-id queryinstalled查询的合约ID</div><div class="line"><span class="meta">#</span> --sequence 序列号</div><div class="line"><span class="meta">#</span> --waitForEvent 等待peer提交交易返回</div><div class="line"><span class="meta">#</span> --init-required 合约是否必须执行init</div><div class="line"><span class="meta">#</span> --peerAddresses 节点路径 </div><div class="line"><span class="meta">#</span> --tlsRootCertFiles 节点ca根证书路径(--peerAddresses --tlsRootCertFiles  连用，可多个节点，多个节点即将合约部署到对应节点集合上)</div></pre></td></tr></table></figure></p>
<p>查看docker容器会发现多了 dev-peerXXXXX容器（该容器是合约链码容器）</p>
<p>查看节点已提交合约<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">peer lifecycle chaincode querycommitted --channelID mychannel --name mycc1</div></pre></td></tr></table></figure></p>
<p>输出内容<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">approvals: &#123;</div><div class="line">    Org1MSP: true,</div><div class="line">    Org2MSP: true</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h4 id="操作合约"><a href="#操作合约" class="headerlink" title="操作合约"></a>操作合约</h4><p>fabric智能合约操作主要有invoke跟query,此处与1.x完全一致<br>初始化合约，执行init方法，设置a:100 b:100<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"> peer chaincode invoke -o orderer.example.com:7050 --tls true \</div><div class="line">--cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem \</div><div class="line">-C mychannel -n mycc1 --peerAddresses peer0.org1.example.com:7051 \</div><div class="line">--tlsRootCertFiles /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.example.com/peers/peer0.org1.example.com/tls/ca.crt \</div><div class="line">--peerAddresses peer0.org2.example.com:7051 \</div><div class="line">--tlsRootCertFiles /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.example.com/peers/peer0.org2.example.com/tls/ca.crt \</div><div class="line">--isInit -c '&#123;"Args":["Init","a","100","b","100"]&#125;'</div></pre></td></tr></table></figure></p>
<p>控制台输出：<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">2020-04-20 09:18:48.685 UTC [chaincodeCmd] chaincodeInvokeOrQuery -&gt; INFO 001 Chaincode invoke successful. result: status:200</div></pre></td></tr></table></figure></p>
<p>查询a的余额<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">peer chaincode query -C mychannel -n mycc2 -c '&#123;"Args":["query","a"]&#125;'</div></pre></td></tr></table></figure></p>
<p>输出值为100</p>
<p>调用 invoke方法， a -&gt;b 转账20<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">peer chaincode invoke -o orderer.example.com:7050 --tls true \</div><div class="line">--cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem \</div><div class="line">-C mychannel -n mycc1 --peerAddresses peer0.org1.example.com:7051 \</div><div class="line">--tlsRootCertFiles /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.example.com/peers/peer0.org1.example.com/tls/ca.crt \</div><div class="line">--peerAddresses peer0.org2.example.com:7051 \</div><div class="line">--tlsRootCertFiles /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.example.com/peers/peer0.org2.example.com/tls/ca.crt  \</div><div class="line">-c  '&#123;"Args":["invoke","a","b","20"]&#125;'</div></pre></td></tr></table></figure></p>
<p>再次查询a时，输出为80</p>
<p>对应raft-4node-swarm代码已上传到git<br>本文档参考 <a href="https://uzshare.com/view/825034" target="_blank" rel="external">https://uzshare.com/view/825034</a> ,做了更详细的实践说明</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://misayachad.github.io/2020/05/20/超级账本 Hyperledger Fabric2.0 多机集群部署/" data-id="ckcly4vm0000kt4us4qkvdy3s" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
  
    <a href="/2018/09/10/运维进程管理supervisorctl使用/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">运维进程管理supervisorctl使用</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">分类</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Android/">Android</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Ethereum/">Ethereum</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Java/">Java</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/JavaEE/">JavaEE</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Linux运维/">Linux运维</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/区块链/">区块链</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/宝典/">宝典</a></li></ul>
    </div>
  </div>


  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/05/">五月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">九月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">八月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/06/">六月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">五月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">十月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">九月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">八月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/08/">八月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/05/">五月 2016</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2020/05/20/超级账本 Hyperledger Fabric2.0 多机集群部署/">超级账本 Hyperledger Fabric2.0 多机集群部署</a>
          </li>
        
          <li>
            <a href="/2018/09/10/运维进程管理supervisorctl使用/">运维进程管理supervisorctl使用</a>
          </li>
        
          <li>
            <a href="/2018/08/01/问题/">问题</a>
          </li>
        
          <li>
            <a href="/2018/06/10/Android刘海屏适配/">Android刘海屏适配</a>
          </li>
        
          <li>
            <a href="/2018/05/10/Java消息服务/">Java消息服务</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2020 MisayaChad<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>